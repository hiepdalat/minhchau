<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Trang ch√≠nh</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Font m·ªÅm m·∫°i -->
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500&display=swap" rel="stylesheet">

  <!-- SweetAlert -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <!-- YouTube Iframe‚ÄØAPI ‚Äì‚ÄØcho ph√©p ƒëi·ªÅu ch·ªânh volume -->
  <script src="https://www.youtube.com/iframe_api"></script>

  <style>
    /* ======= N·ªÄN & B·ªê C·ª§C ======= */
    body{
      margin:0;
      font-family:'Quicksand',sans-serif;
      display:flex;
      justify-content:center;
      align-items:center;
      min-height:100vh;
      background-image:url('https://raw.githubusercontent.com/hiepdalat/minhchau/main/public/hinhnen.jpg');
      background-size:cover;
      background-position:center;
      background-repeat:no-repeat;
      background-attachment:fixed;
    }

    /* ======= H·ªòP ƒêƒÇNG NH·∫¨P ======= */
    .box{
      background:rgba(255,255,255,.85);
      backdrop-filter:blur(6px);
      padding:36px 30px;
      border-radius:20px;
      box-shadow:0 8px 24px rgba(0,0,0,.2);
      width:320px;
      text-align:center;
    }
    h2{
      color:#4a90e2;
      margin:0 0 20px;
      font-size:24px;
    }
    input{
      width:100%;
      padding:12px;
      margin:10px 0;
      border:none;
      border-radius:10px;
      background:#f9f9f9;
      box-shadow:inset 0 0 4px rgba(0,0,0,.1);
      font-size:15px;
    }

    /* ======= N√öT CH·ª®C NƒÇNG ======= */
    .btn{
      width:100%;
      padding:12px;
      margin-top:12px;
      border:none;
      border-radius:12px;
      font-size:16px;
      font-weight:bold;
      color:#fff;
      cursor:pointer;
      transition:all .3s;
    }
    .btn-congno{background:#6C63FF;}
    .btn-kho   {background:#57C478;}
    .btn-bh    {background:#FF8C42;}
    .btn:hover{opacity:.92;transform:scale(1.03);}
    hr{margin:24px 0;border:0;border-top:1px solid #ddd;}

    /* ======= TR√åNH PH√ÅT NH·∫†C ======= */
    .music-box{
      margin-top:24px;
      text-align:center;
    }
    #volumeControl{
      width:160px;
      margin-top:10px;
      appearance:none;
      height:6px;
      border-radius:4px;
      background:#ccc;
      outline:none;
      cursor:pointer;
    }
    #volumeControl::-webkit-slider-thumb{
      appearance:none;
      width:14px;height:14px;
      border-radius:50%;
      background:#4a90e2;
      border:none;
    }
  </style>
</head>

<body>
  <!-- ==== H·ªòP ƒêƒÇNG NH·∫¨P ==== -->
  <div class="box">
    <h2>üåº ƒêƒÉng nh·∫≠p h·ªá th·ªëng</h2>
    <input id="username" placeholder="üë§ T√†i kho·∫£n">
    <input id="password" type="password" placeholder="üîí M·∫≠t kh·∫©u">

    <hr>

    <button class="btn btn-congno" onclick="chucNang('/congno.html')">üìí Qu·∫£n L√Ω C√¥ng N·ª£</button>
    <button class="btn btn-kho"     onclick="chucNang('/khohang.html')">üì¶ Qu·∫£n L√Ω Kho</button>
    <button class="btn btn-bh"      onclick="chucNang('/banhang.html')">üõí Qu·∫£n L√Ω B√°n H√†ng</button>

    <!-- ==== TR√åNH PH√ÅT NH·∫†C ==== -->
    <div class="music-box">
      <!-- Player ·∫©n (0√ó0) ƒë·ªÉ ch·ªâ l·∫•y √¢m thanh -->
      <div id="ytPlayer"></div>
      <input type="range" id="volumeControl" min="0" max="100" value="70">
    </div>
  </div>

  <script>
    /* ====================== LOGIN ====================== */
    let isLoggedIn = false;
    async function loginIfNeeded(){
      if(isLoggedIn) return true;
      const username=document.getElementById('username').value.trim();
      const password=document.getElementById('password').value.trim();
      if(!username||!password){
        Swal.fire('Thi·∫øu th√¥ng tin','Vui l√≤ng nh·∫≠p t√†i kho·∫£n v√† m·∫≠t kh·∫©u!','warning');
        return false;
      }
      try{
        const res=await fetch('/login',{
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body:JSON.stringify({username,password})
        });
        if(res.ok){isLoggedIn=true;return true;}
        else{
          const text=await res.text();
          Swal.fire('L·ªói ƒëƒÉng nh·∫≠p',text||'Sai t√†i kho·∫£n ho·∫∑c m·∫≠t kh·∫©u!','error');
          return false;
        }
      }catch{
        Swal.fire('L·ªói','Kh√¥ng k·∫øt n·ªëi ƒë∆∞·ª£c server.','error');
        return false;
      }
    }
    async function chucNang(path){
      const ok=await loginIfNeeded();
      if(ok) window.location.href=path;
    }
    document.getElementById('password')
      .addEventListener('keydown',e=>{if(e.key==='Enter') chucNang('/congno.html');});

    /* ====================== YOUTUBE AUDIO ====================== */
    let player; // ƒë·ªëi t∆∞·ª£ng YT.Player

    // H√†m ƒë∆∞·ª£c g·ªçi khi API YouTube s·∫µn s√†ng
    function onYouTubeIframeAPIReady(){
      player=new YT.Player('ytPlayer',{
        height:'0',
        width:'0',
        playerVars:{
          listType:'playlist',
          list:'PLB1F2BC6D6A2A2204', // playlist nh·∫°c b·∫•t h·ªß kh√¥ng l·ªùi
          autoplay:1,
          loop:1,
          mute:0
        },
        events:{onReady:onPlayerReady}
      });
    }

    function onPlayerReady(){
      player.setVolume(70);            // Volume m·∫∑c ƒë·ªãnh 70%
      player.playVideo();
    }

    // ƒêi·ªÅu ch·ªânh √¢m l∆∞·ª£ng qua slider
    document.getElementById('volumeControl')
      .addEventListener('input', e=>{
        const vol = parseInt(e.target.value,10);
        if(player && player.setVolume) player.setVolume(vol);
      });
  </script>
</body>
</html>
